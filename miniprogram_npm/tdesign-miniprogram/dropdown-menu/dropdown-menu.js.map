{"version":3,"sources":["../src/dropdown-menu/dropdown-menu.ts"],"names":[],"mappings":";;;;;;AAAA,OAAO,EAAoB,cAAc,EAAE,WAAW,EAAE,MAAM,qBAAqB,CAAC;AACpF,OAAO,MAAM,MAAM,kBAAkB,CAAC;AACtC,OAAO,KAAK,MAAM,SAAS,CAAC;AAG5B,MAAM,EAAE,MAAM,EAAE,GAAG,MAAM,CAAC;AAC1B,MAAM,IAAI,GAAG,GAAG,MAAM,gBAAgB,CAAC;AAKvC,IAAqB,YAAY,GAAjC,MAAqB,YAAa,SAAQ,cAAc;IAAxD;;QACE,eAAU,GAAG,KAAK,CAAC,CAAC,2BAA2B;QAE/C,SAAI,GAAG;YACL,MAAM;YACN,WAAW,EAAE,IAAI;YACjB,KAAK,EAAE,IAAI;YACX,KAAK,EAAE,IAAI;YACX,SAAS,EAAE,CAAC,CAAC;YACb,MAAM,EAAE,CAAC;SACV,CAAC;QAEF,cAAS,GAAqB;YAC5B,iBAAiB,EAAE;gBACjB,IAAI,EAAE,OAAO;aACd;SACF,CAAC;QAEF,cAAS,GAAG;YACV,KAAK;gBACH,IAAI,CAAC,WAAW,EAAE,CAAC;YACrB,CAAC;SACF,CAAC;QAEF,YAAO,GAAG;YACR,WAAW;gBACT,MAAM,KAAK,GAAG,IAAI,CAAC,gBAAgB,CAAC,iBAAiB,CAAC,CAAC;gBACvD,MAAM,KAAK,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;gBAEvC,IAAI,CAAC,OAAO,CAAC;oBACX,KAAK;oBACL,KAAK;iBACN,CAAC,CAAC;YACL,CAAC;YACD,cAAc,CAAC,CAA8B;gBAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC;gBACxC,MAAM,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC;gBAC1C,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;gBAC5C,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;gBAEtC,IAAI,QAAQ,CAAC,IAAI,CAAC,QAAQ;oBAAE,OAAO;gBAEnC,IAAI,SAAS,KAAK,CAAC,CAAC,EAAE;oBACpB,QAAQ,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;oBAC/B,QAAQ,CAAC,OAAO,CACd;wBACE,IAAI,EAAE,KAAK;qBACZ,EACD,GAAG,EAAE;wBACH,UAAU,CAAC,GAAG,EAAE;4BACd,QAAQ,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;wBAClC,CAAC,EAAE,QAAQ,CAAC,CAAC;oBACf,CAAC,CACF,CAAC;iBACH;gBAED,IAAI,SAAS,KAAK,GAAG,EAAE;oBACrB,IAAI,CAAC,OAAO,CAAC;wBACX,SAAS,EAAE,CAAC,CAAC;qBACd,CAAC,CAAC;iBACJ;qBAAM;oBACL,QAAQ,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC;oBAC9B,IAAI,CAAC,OAAO,CAAC;wBACX,SAAS,EAAE,GAAG;qBACf,CAAC,CAAC;oBACH,QAAQ,CAAC,OAAO,CACd;wBACE,IAAI,EAAE,IAAI;qBACX,EACD,GAAG,EAAE;wBACH,UAAU,CAAC,GAAG,EAAE;4BACd,QAAQ,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;wBAClC,CAAC,EAAE,QAAQ,CAAC,CAAC;oBACf,CAAC,CACF,CAAC;iBACH;YACH,CAAC;SACF,CAAC;IACJ,CAAC;CAAA,CAAA;AA9EoB,YAAY;IADhC,WAAW,EAAE;GACO,YAAY,CA8EhC;eA9EoB,YAAY","file":"dropdown-menu.js","sourcesContent":["import { RelationsOptions, SuperComponent, wxComponent } from '../common/src/index';\nimport config from '../common/config';\nimport props from './props';\nimport type { TdDropdownMenuProps } from './type';\n\nconst { prefix } = config;\nconst name = `${prefix}-dropdown-menu`;\n\nexport interface DropdownMenuProps extends TdDropdownMenuProps {}\n\n@wxComponent()\nexport default class DropdownMenu extends SuperComponent {\n  properties = props; // todo: zindex activeColor\n\n  data = {\n    prefix,\n    classPrefix: name,\n    nodes: null,\n    menus: null,\n    activeIdx: -1,\n    bottom: 0,\n  };\n\n  relations: RelationsOptions = {\n    './dropdown-item': {\n      type: 'child',\n    },\n  };\n\n  lifetimes = {\n    ready() {\n      this.getAllItems();\n    },\n  };\n\n  methods = {\n    getAllItems() {\n      const nodes = this.getRelationNodes('./dropdown-item');\n      const menus = nodes.map((a) => a.data);\n\n      this.setData({\n        nodes,\n        menus,\n      });\n    },\n    toggleDropdown(e: WechatMiniprogram.BaseEvent) {\n      const { index: idx } = e.target.dataset;\n      const { activeIdx, duration } = this.data;\n      const prevItem = this.data.nodes[activeIdx];\n      const currItem = this.data.nodes[idx];\n\n      if (currItem.data.disabled) return;\n\n      if (activeIdx !== -1) {\n        prevItem.triggerEvent('close');\n        prevItem.setData(\n          {\n            show: false,\n          },\n          () => {\n            setTimeout(() => {\n              prevItem.triggerEvent('closed');\n            }, duration);\n          },\n        );\n      }\n\n      if (activeIdx === idx) {\n        this.setData({\n          activeIdx: -1,\n        });\n      } else {\n        currItem.triggerEvent('open');\n        this.setData({\n          activeIdx: idx,\n        });\n        currItem.setData(\n          {\n            show: true,\n          },\n          () => {\n            setTimeout(() => {\n              currItem.triggerEvent('opened');\n            }, duration);\n          },\n        );\n      }\n    },\n  };\n}\n"]}