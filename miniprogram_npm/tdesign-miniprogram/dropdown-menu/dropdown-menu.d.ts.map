{"version":3,"sources":["../src/dropdown-menu/dropdown-menu.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,gBAAgB,EAAE,cAAc,EAAe,MAAM,qBAAqB,CAAC;AAGpF,OAAO,KAAK,EAAE,mBAAmB,EAAE,MAAM,QAAQ,CAAC;AAKlD,MAAM,WAAW,iBAAkB,SAAQ,mBAAmB;CAAG;AAGjE,MAAM,CAAC,OAAO,OAAO,YAAa,SAAQ,cAAc;IACtD,UAAU,sBAAS;IAEnB,IAAI;;;;;;;MAOF;IAEF,SAAS,EAAE,gBAAgB,CAIzB;IAEF,SAAS;;MAIP;IAEF,OAAO;;0BAUa,kBAAkB,SAAS;MA2C7C;CACH","file":"dropdown-menu.d.ts","sourcesContent":["import { RelationsOptions, SuperComponent, wxComponent } from '../common/src/index';\nimport config from '../common/config';\nimport props from './props';\nimport type { TdDropdownMenuProps } from './type';\n\nconst { prefix } = config;\nconst name = `${prefix}-dropdown-menu`;\n\nexport interface DropdownMenuProps extends TdDropdownMenuProps {}\n\n@wxComponent()\nexport default class DropdownMenu extends SuperComponent {\n  properties = props; // todo: zindex activeColor\n\n  data = {\n    prefix,\n    classPrefix: name,\n    nodes: null,\n    menus: null,\n    activeIdx: -1,\n    bottom: 0,\n  };\n\n  relations: RelationsOptions = {\n    './dropdown-item': {\n      type: 'child',\n    },\n  };\n\n  lifetimes = {\n    ready() {\n      this.getAllItems();\n    },\n  };\n\n  methods = {\n    getAllItems() {\n      const nodes = this.getRelationNodes('./dropdown-item');\n      const menus = nodes.map((a) => a.data);\n\n      this.setData({\n        nodes,\n        menus,\n      });\n    },\n    toggleDropdown(e: WechatMiniprogram.BaseEvent) {\n      const { index: idx } = e.target.dataset;\n      const { activeIdx, duration } = this.data;\n      const prevItem = this.data.nodes[activeIdx];\n      const currItem = this.data.nodes[idx];\n\n      if (currItem.data.disabled) return;\n\n      if (activeIdx !== -1) {\n        prevItem.triggerEvent('close');\n        prevItem.setData(\n          {\n            show: false,\n          },\n          () => {\n            setTimeout(() => {\n              prevItem.triggerEvent('closed');\n            }, duration);\n          },\n        );\n      }\n\n      if (activeIdx === idx) {\n        this.setData({\n          activeIdx: -1,\n        });\n      } else {\n        currItem.triggerEvent('open');\n        this.setData({\n          activeIdx: idx,\n        });\n        currItem.setData(\n          {\n            show: true,\n          },\n          () => {\n            setTimeout(() => {\n              currItem.triggerEvent('opened');\n            }, duration);\n          },\n        );\n      }\n    },\n  };\n}\n"]}