{"version":3,"sources":["../src/steps/step-item.ts"],"names":[],"mappings":"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","file":"step-item.js","sourcesContent":["import { wxComponent, SuperComponent, RelationsOptions } from '../common/src/index';\nimport config from '../common/config';\nimport props from './step-item-props';\n\nconst { prefix } = config;\n\n@wxComponent()\nexport default class StepItem extends SuperComponent {\n  options = {\n    multipleSlots: true,\n  };\n\n  relations: RelationsOptions = {\n    './steps': {\n      type: 'ancestor',\n    },\n  };\n\n  externalClasses = [\n    `${prefix}-class`,\n    `${prefix}-class-content`,\n    `${prefix}-class-title`,\n    `${prefix}-class-description`,\n    `${prefix}-class-extra`,\n  ];\n\n  properties = props;\n\n  // 组件的内部数据\n  data = {\n    classPrefix: `${prefix}-steps-item`,\n    prefix,\n    rootClassName: '',\n    parent: null,\n    index: 0,\n    isDot: false,\n    curStatus: '',\n    curSubStepItems: [],\n    curSubStepItemsStatus: [],\n    layout: 'vertical',\n    type: 'default',\n    isLastChild: false,\n    isLarge: false,\n    readonly: false,\n    computedIcon: '',\n  };\n\n  observers = {\n    icon(val) {\n      this.setData({\n        computedIcon: val,\n      });\n    },\n  };\n\n  lifetimes = {\n    ready() {\n      const [parent] = this.getRelationNodes('./steps') || [];\n\n      if (parent) {\n        this.setData({\n          parent,\n        });\n      }\n    },\n  };\n\n  methods = {\n    updateStatus(current, currentStatus, index, theme, layout, steps, readonly) {\n      const _current = String(current);\n      const connectLine = '-';\n\n      const judgeObjAttr = (data, attr: string) => {\n        return Array.isArray(data[attr]) && data[attr].length;\n      };\n\n      const getStepLevel = (s) => {\n        const reg = new RegExp(`(.*)${connectLine}{1}.*`);\n        return s.replace(reg, '$1');\n      };\n\n      const isSameLevelStep = (stepsTag: string, current: string) => {\n        return stepsTag.length < current.length && getStepLevel(stepsTag) === getStepLevel(current);\n      };\n\n      /**\n       * 步骤条状态优先级：status > currentStatus > 子步骤影响\n       * 子步骤影响优先级： finish > error > process\n       */\n      const stepFinalStatus = (item, itemTag, current: string, currentStatus) => {\n        let tempStepStatus = '';\n        if (item.status !== 'default' && item.status !== undefined) {\n          tempStepStatus = item.status === '' ? 'default' : item.status;\n        } else {\n          tempStepStatus = 'default';\n          if (itemTag < current) {\n            tempStepStatus = 'finish';\n          } else if (itemTag === current && item.status !== '') {\n            tempStepStatus = currentStatus;\n          }\n\n          if (isSameLevelStep(itemTag, current)) {\n            if (judgeObjAttr(item, 'subStepItems')) {\n              const tempStepItemsStatus = item.subStepItems.map((subItem, subIndex) => {\n                const subItemTag = `${itemTag}${connectLine}${subIndex}`;\n                return stepFinalStatus(subItem, subItemTag, current, currentStatus);\n              });\n\n              if (tempStepItemsStatus[tempStepItemsStatus.length - 1] === 'finish') {\n                tempStepStatus = 'finish';\n                return tempStepStatus;\n              }\n              if (tempStepItemsStatus.includes('process') || tempStepItemsStatus.every((item) => item === 'default')) {\n                tempStepStatus = 'process';\n              }\n              if (tempStepItemsStatus.includes('error')) {\n                tempStepStatus = 'error';\n              }\n            }\n          }\n        }\n        return tempStepStatus;\n      };\n\n      // step status\n      this.data.tempStatus = stepFinalStatus(this.data, String(index), _current, currentStatus);\n      const tempStatusList = [];\n      if (judgeObjAttr(this.data, 'subStepItems')) {\n        this.data.subStepItems.forEach((subItem, subIndex) => {\n          tempStatusList.push(stepFinalStatus(subItem, `${index}${connectLine}${subIndex}`, _current, currentStatus));\n        });\n      }\n\n      // update icon\n      const tempIcon = new Map([\n        ['finish', 'check'],\n        ['error', 'close'],\n      ]);\n      let iconStatus = '';\n      if (readonly && tempIcon.has(this.data.tempStatus)) {\n        iconStatus = tempIcon.get(this.data.tempStatus);\n      }\n\n      this.setData({\n        curStatus: this.data.tempStatus,\n        curSubStepItems: this.data.subStepItems || [],\n        curSubStepItemsStatus: tempStatusList || [],\n        computedIcon: iconStatus || this.data.icon,\n        index,\n        isDot: theme === 'dot' && layout === 'vertical',\n        layout,\n        theme,\n        isLastChild: steps.length - 1 === index,\n      });\n    },\n    click() {\n      this.data.parent.handleClick(this.data.index);\n    },\n  };\n}\n"]}